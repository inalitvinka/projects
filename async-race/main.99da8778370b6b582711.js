(()=>{var t={42:function(t,e,n){t.exports=function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var e=t((function(t,e){t.exports=function(){function t(t){return t&&"object"==typeof t&&"[object RegExp]"!==Object.prototype.toString.call(t)&&"[object Date]"!==Object.prototype.toString.call(t)}function e(t){return Array.isArray(t)?[]:{}}function n(n,r){return r&&!0===r.clone&&t(n)?s(e(n),n,r):n}function r(e,r,i){var o=e.slice();return r.forEach((function(r,a){void 0===o[a]?o[a]=n(r,i):t(r)?o[a]=s(e[a],r,i):-1===e.indexOf(r)&&o.push(n(r,i))})),o}function i(e,r,i){var o={};return t(e)&&Object.keys(e).forEach((function(t){o[t]=n(e[t],i)})),Object.keys(r).forEach((function(a){t(r[a])&&e[a]?o[a]=s(e[a],r[a],i):o[a]=n(r[a],i)})),o}function s(t,e,s){var o=Array.isArray(e),a=(s||{arrayMerge:r}).arrayMerge||r;return o?Array.isArray(t)?a(t,e,s):n(e,s):i(t,e,s)}return s.all=function(t,e){if(!Array.isArray(t)||t.length<2)throw new Error("first argument should be an array with at least two elements");return t.reduce((function(t,n){return s(t,n,e)}))},s}()}));var r=t((function(t,e){e.default={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}},t.exports=e.default})),i=r.svg,s=r.xlink,o={};o[i.name]=i.uri,o[s.name]=s.uri;var a,c=function(t,n){return void 0===t&&(t=""),"<svg "+function(t){return Object.keys(t).map((function(e){return e+'="'+t[e].toString().replace(/"/g,"&quot;")+'"'})).join(" ")}(e(o,n||{}))+">"+t+"</svg>"},d=r.svg,u=r.xlink,l={attrs:(a={style:["position: absolute","width: 0","height: 0"].join("; "),"aria-hidden":"true"},a[d.name]=d.uri,a[u.name]=u.uri,a)},h=function(t){this.config=e(l,t||{}),this.symbols=[]};h.prototype.add=function(t){var e=this.symbols,n=this.find(t.id);return n?(e[e.indexOf(n)]=t,!1):(e.push(t),!0)},h.prototype.remove=function(t){var e=this.symbols,n=this.find(t);return!!n&&(e.splice(e.indexOf(n),1),n.destroy(),!0)},h.prototype.find=function(t){return this.symbols.filter((function(e){return e.id===t}))[0]||null},h.prototype.has=function(t){return null!==this.find(t)},h.prototype.stringify=function(){var t=this.config.attrs,e=this.symbols.map((function(t){return t.stringify()})).join("");return c(e,t)},h.prototype.toString=function(){return this.stringify()},h.prototype.destroy=function(){this.symbols.forEach((function(t){return t.destroy()}))};var m=function(t){var e=t.id,n=t.viewBox,r=t.content;this.id=e,this.viewBox=n,this.content=r};m.prototype.stringify=function(){return this.content},m.prototype.toString=function(){return this.stringify()},m.prototype.destroy=function(){var t=this;["id","viewBox","content"].forEach((function(e){return delete t[e]}))};var p=function(t){var e=!!document.importNode,n=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement;return e?document.importNode(n,!0):n},g=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={isMounted:{}};return n.isMounted.get=function(){return!!this.node},e.createFromExistingNode=function(t){return new e({id:t.getAttribute("id"),viewBox:t.getAttribute("viewBox"),content:t.outerHTML})},e.prototype.destroy=function(){this.isMounted&&this.unmount(),t.prototype.destroy.call(this)},e.prototype.mount=function(t){if(this.isMounted)return this.node;var e="string"==typeof t?document.querySelector(t):t,n=this.render();return this.node=n,e.appendChild(n),n},e.prototype.render=function(){var t=this.stringify();return p(c(t)).childNodes[0]},e.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(e.prototype,n),e}(m),w={autoConfigure:!0,mountTo:"body",syncUrlsWithBaseTag:!1,listenLocationChangeEvent:!0,locationChangeEvent:"locationChange",locationChangeAngularEmitter:!1,usagesToUpdate:"use[*|href]",moveGradientsOutsideSymbol:!1},f=function(t){return Array.prototype.slice.call(t,0)},y=function(){return/firefox/i.test(navigator.userAgent)},N=function(){return/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)},v=function(){return/edge/i.test(navigator.userAgent)},C=function(t){return(t||window.location.href).split("#")[0]},b=function(t){angular.module("ng").run(["$rootScope",function(e){e.$on("$locationChangeSuccess",(function(e,n,r){var i,s,o;i=t,s={oldUrl:r,newUrl:n},(o=document.createEvent("CustomEvent")).initCustomEvent(i,!1,!1,s),window.dispatchEvent(o)}))}])},E=function(t,e){return void 0===e&&(e="linearGradient, radialGradient, pattern, mask, clipPath"),f(t.querySelectorAll("symbol")).forEach((function(t){f(t.querySelectorAll(e)).forEach((function(e){t.parentNode.insertBefore(e,t)}))})),t};var A=r.xlink.uri,B="xlink:href",S=/[{}|\\\^\[\]`"<>]/g;function x(t){return t.replace(S,(function(t){return"%"+t[0].charCodeAt(0).toString(16).toUpperCase()}))}var I,T=["clipPath","colorProfile","src","cursor","fill","filter","marker","markerStart","markerMid","markerEnd","mask","stroke","style"],O=T.map((function(t){return"["+t+"]"})).join(","),R=function(t,e,n,r){var i,s,o=x(n),a=x(r);(i=t.querySelectorAll(O),s=function(t){var e=t.localName,n=t.value;return-1!==T.indexOf(e)&&-1!==n.indexOf("url("+o)},f(i).reduce((function(t,e){if(!e.attributes)return t;var n=f(e.attributes),r=s?n.filter(s):n;return t.concat(r)}),[])).forEach((function(t){return t.value=t.value.replace(new RegExp(o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),a)})),function(t,e,n){f(t).forEach((function(t){var r=t.getAttribute(B);if(r&&0===r.indexOf(e)){var i=r.replace(e,n);t.setAttributeNS(A,B,i)}}))}(e,o,a)},W="mount",_="symbol_mount",M=function(t){function n(n){var r=this;void 0===n&&(n={}),t.call(this,e(w,n));var i,s=(i=i||Object.create(null),{on:function(t,e){(i[t]||(i[t]=[])).push(e)},off:function(t,e){i[t]&&i[t].splice(i[t].indexOf(e)>>>0,1)},emit:function(t,e){(i[t]||[]).map((function(t){t(e)})),(i["*"]||[]).map((function(n){n(t,e)}))}});this._emitter=s,this.node=null;var o=this.config;if(o.autoConfigure&&this._autoConfigure(n),o.syncUrlsWithBaseTag){var a=document.getElementsByTagName("base")[0].getAttribute("href");s.on(W,(function(){return r.updateUrls("#",a)}))}var c=this._handleLocationChange.bind(this);this._handleLocationChange=c,o.listenLocationChangeEvent&&window.addEventListener(o.locationChangeEvent,c),o.locationChangeAngularEmitter&&b(o.locationChangeEvent),s.on(W,(function(t){o.moveGradientsOutsideSymbol&&E(t)})),s.on(_,(function(t){var e;o.moveGradientsOutsideSymbol&&E(t.parentNode),(N()||v())&&(e=[],f(t.querySelectorAll("style")).forEach((function(t){t.textContent+="",e.push(t)})))}))}t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n;var r={isMounted:{}};return r.isMounted.get=function(){return!!this.node},n.prototype._autoConfigure=function(t){var e=this.config;void 0===t.syncUrlsWithBaseTag&&(e.syncUrlsWithBaseTag=void 0!==document.getElementsByTagName("base")[0]),void 0===t.locationChangeAngularEmitter&&(e.locationChangeAngularEmitter=void 0!==window.angular),void 0===t.moveGradientsOutsideSymbol&&(e.moveGradientsOutsideSymbol=y())},n.prototype._handleLocationChange=function(t){var e=t.detail,n=e.oldUrl,r=e.newUrl;this.updateUrls(n,r)},n.prototype.add=function(e){var n=t.prototype.add.call(this,e);return this.isMounted&&n&&(e.mount(this.node),this._emitter.emit(_,e.node)),n},n.prototype.attach=function(t){var e=this,n=this;if(n.isMounted)return n.node;var r="string"==typeof t?document.querySelector(t):t;return n.node=r,this.symbols.forEach((function(t){t.mount(n.node),e._emitter.emit(_,t.node)})),f(r.querySelectorAll("symbol")).forEach((function(t){var e=g.createFromExistingNode(t);e.node=t,n.add(e)})),this._emitter.emit(W,r),r},n.prototype.destroy=function(){var t=this,e=t.config,n=t.symbols,r=t._emitter;n.forEach((function(t){return t.destroy()})),r.off("*"),window.removeEventListener(e.locationChangeEvent,this._handleLocationChange),this.isMounted&&this.unmount()},n.prototype.mount=function(t,e){void 0===t&&(t=this.config.mountTo),void 0===e&&(e=!1);var n=this;if(n.isMounted)return n.node;var r="string"==typeof t?document.querySelector(t):t,i=n.render();return this.node=i,e&&r.childNodes[0]?r.insertBefore(i,r.childNodes[0]):r.appendChild(i),this._emitter.emit(W,i),i},n.prototype.render=function(){return p(this.stringify())},n.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},n.prototype.updateUrls=function(t,e){if(!this.isMounted)return!1;var n=document.querySelectorAll(this.config.usagesToUpdate);return R(this.node,n,C(t)+"#",C(e)+"#"),!0},Object.defineProperties(n.prototype,r),n}(h),k=t((function(t){var e;e=function(){var t,e=[],n=document,r=n.documentElement.doScroll,i="DOMContentLoaded",s=(r?/^loaded|^c/:/^loaded|^i|^c/).test(n.readyState);return s||n.addEventListener(i,t=function(){for(n.removeEventListener(i,t),s=1;t=e.shift();)t()}),function(t){s?setTimeout(t,0):e.push(t)}},t.exports=e()})),P="__SVG_SPRITE_NODE__",$="__SVG_SPRITE__";window[$]?I=window[$]:(I=new M({attrs:{id:P,"aria-hidden":"true"}}),window[$]=I);var L=function(){var t=document.getElementById(P);t?I.attach(t):I.mount(document.body,!0)};return document.body?L():k(L),I}()},897:function(t,e,n){t.exports=function(){"use strict";var t=function(t){var e=t.id,n=t.viewBox,r=t.content;this.id=e,this.viewBox=n,this.content=r};t.prototype.stringify=function(){return this.content},t.prototype.toString=function(){return this.stringify()},t.prototype.destroy=function(){var t=this;["id","viewBox","content"].forEach((function(e){return delete t[e]}))};function e(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var r=e((function(t,e){t.exports=function(){function t(t){return t&&"object"==typeof t&&"[object RegExp]"!==Object.prototype.toString.call(t)&&"[object Date]"!==Object.prototype.toString.call(t)}function e(t){return Array.isArray(t)?[]:{}}function n(n,r){return r&&!0===r.clone&&t(n)?s(e(n),n,r):n}function r(e,r,i){var o=e.slice();return r.forEach((function(r,a){void 0===o[a]?o[a]=n(r,i):t(r)?o[a]=s(e[a],r,i):-1===e.indexOf(r)&&o.push(n(r,i))})),o}function i(e,r,i){var o={};return t(e)&&Object.keys(e).forEach((function(t){o[t]=n(e[t],i)})),Object.keys(r).forEach((function(a){t(r[a])&&e[a]?o[a]=s(e[a],r[a],i):o[a]=n(r[a],i)})),o}function s(t,e,s){var o=Array.isArray(e),a=(s||{arrayMerge:r}).arrayMerge||r;return o?Array.isArray(t)?a(t,e,s):n(e,s):i(t,e,s)}return s.all=function(t,e){if(!Array.isArray(t)||t.length<2)throw new Error("first argument should be an array with at least two elements");return t.reduce((function(t,n){return s(t,n,e)}))},s}()})),i=e((function(t,e){e.default={svg:{name:"xmlns",uri:"http://www.w3.org/2000/svg"},xlink:{name:"xmlns:xlink",uri:"http://www.w3.org/1999/xlink"}},t.exports=e.default})),s=i.svg,o=i.xlink,a={};a[s.name]=s.uri,a[o.name]=o.uri;var c=function(t,e){return void 0===t&&(t=""),"<svg "+function(t){return Object.keys(t).map((function(e){return e+'="'+t[e].toString().replace(/"/g,"&quot;")+'"'})).join(" ")}(r(a,e||{}))+">"+t+"</svg>"},d=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={isMounted:{}};return n.isMounted.get=function(){return!!this.node},e.createFromExistingNode=function(t){return new e({id:t.getAttribute("id"),viewBox:t.getAttribute("viewBox"),content:t.outerHTML})},e.prototype.destroy=function(){this.isMounted&&this.unmount(),t.prototype.destroy.call(this)},e.prototype.mount=function(t){if(this.isMounted)return this.node;var e="string"==typeof t?document.querySelector(t):t,n=this.render();return this.node=n,e.appendChild(n),n},e.prototype.render=function(){var t=this.stringify();return function(t){var e=!!document.importNode,n=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement;return e?document.importNode(n,!0):n}(c(t)).childNodes[0]},e.prototype.unmount=function(){this.node.parentNode.removeChild(this.node)},Object.defineProperties(e.prototype,n),e}(t);return d}()}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{"use strict";class t{constructor({tag:t="div",className:e=[],text:n="",attributes:r={},children:i=[]}){this.children=[];const s=document.createElement(t);this.node=s,this.children=i,e&&this.setClassName(e),r&&this.setAttribute(r),n&&this.setTextContent(n),i&&this.appendChildren(i)}append(t){this.node.append(t.getNode())}appendChildren(t){t.forEach((t=>{this.node.append(t)}))}getNode(){return this.node}getChildren(){return this.children}setTextContent(t){this.node.textContent=t}setClassName(t){t.forEach((t=>{this.node.classList.add(t)}))}removeClassName(t){t.forEach((t=>{this.node.classList.remove(t)}))}setAttribute(t){Object.entries(t).forEach((([t,e])=>{this.node.setAttribute(t,e)}))}removeAttribute(t){this.node.removeAttribute(t)}toggleClass(t){this.node.classList.toggle(t)}addListener(t,e){this.node.addEventListener(t,e)}removeListener(t,e){this.node.removeEventListener(t,e)}destroyChildren(){for(;this.node.firstElementChild;)this.node.firstElementChild.remove()}destroy(){this.destroyChildren(),this.node.remove()}}class e extends t{constructor(t,e,n){super({tag:"button",className:t,text:e,attributes:n})}addOnClick(t){this.onClick=t,this.addListener("click",t)}destroy(){this.onClick&&this.removeListener("click",this.onClick),super.destroy()}}const r=[{name:"Alfa Romeo",models:["Montreal","Spider","Stelvio"]},{name:"Audi",models:["V8","A8","TT"]},{name:"BMW",models:["X7","M2 Couple","i8"]},{name:"Bentley",models:["Azure","Continental","Turbo S"]},{name:"Chrysler",models:["New Yorker","Crossfire","200"]},{name:"Dodge",models:["Husky","Kingsway","Matador"]},{name:"Ferrari",models:["California","Daytona SP3","America"]},{name:"Fiat",models:["Fastback","Pulse","Panda"]},{name:"Ford",models:["Everest","Edge","Escape","Puma"]},{name:"Honda",models:["Civic","Accord","Odyssey","City"]},{name:"Huyndai",models:["Sonata","Pony","Scoupe"]},{name:"Infinity",models:["G Line","JX","Q30","QX70"]},{name:"Jaguar",models:["Costin","Knobbly","R-Coupe","XK-E"]},{name:"KIA",models:["Soul","Carnival","Sonet","Kue"]},{name:"Lamborghini",models:["Urus","Temerario","400 GT","Jalpa","Gallardo","HuracÃ¡n"]},{name:"Land Rover",models:["Freelander","Discovery Sport","Defender"]},{name:"Lexus",models:["ES","LBX"]},{name:"Mazda",models:["Metro","Luce","Allegro","Capella","Cosmo"]},{name:"Maserati",models:["Quattroporte","Ghibli","Merak","Biturbo"]},{name:"Mercedes",models:["Sauber C8","Performance","Hybrid","Power+"]},{name:"Mitsubishi",models:["Montero","Triton","Mirage","Xpander"]},{name:"Nissan",models:["Altima","Murano","Skyline","Pathfinder","Serena"]},{name:"Porsche",models:["911","Macan","Panamera","918 Spander","Taycan"]},{name:"Rolls Royce",models:["Twenty","Corniche","Silver Spirit","Phantom"]},{name:"SEAT",models:["Tarraco","Ateca","Arona","Alhambra"]},{name:"Subaru",models:["Impreza","Crosstrek","Forester","Solterra"]},{name:"Toyota",models:["Camry","Avalon","Century","Corolla","RAV4"]},{name:"Volkswagen",models:["Touareg","Tiguan","Arteon","Nivus"]},{name:"Volvo",models:["V40","\tXC Classic","Century","Corolla"]}];function i(){const t=Math.floor(Math.random()*r.length),e=Math.floor(Math.random()*r[t].models.length);return`${r[t].name} ${r[t].models[e]}`}const s=new class{constructor(){this.GARAGE="http://127.0.0.1:3000/garage",this.ENGINE="http://127.0.0.1:3000/engine",this.WINNERS="http://127.0.0.1:3000/winners"}async getCars(t,e=7){const n=await fetch(`${this.GARAGE}?_page=${t}&_limit=${e}`),r=await n.json();if(!function(t){return Array.isArray(t)&&t.every((t=>t&&"color"in t&&"id"in t&&"name"in t))}(r))throw new TypeError("Invalid car data");return r}async getCar(t){const e=await fetch(`${this.GARAGE}/${t}`),n=await e.json();if(!function(t){return"object"==typeof t&&null!==t&&"color"in t&&"id"in t&&"name"in t}(n))throw new TypeError("Invalid car data");return n}async getAllCars(){return(await fetch(`${this.GARAGE}?_limit=7`)).headers.get("X-Total-Count")}async startCar(t){const e=await fetch(`${this.ENGINE}?id=${t}&status=started`,{method:"PATCH"}),n=await e.json();if("object"!=typeof n||null===n)throw new TypeError("Invalid data");let r=null,i=null;if("distance"in n&&"number"==typeof n.distance&&(r=n.distance),"velocity"in n&&"number"==typeof n.velocity&&(i=n.velocity),null===r||null===i)throw new TypeError("Invalid data");return{distance:r,velocity:i}}async driveCar(t,e){return await fetch(`${this.ENGINE}?id=${t}&status=drive`,{method:"PATCH",signal:e.signal})}async stopCar(t){return await fetch(`${this.ENGINE}?id=${t}&status=stopped`,{method:"PATCH"})}async createCar(t,e){const n=JSON.stringify({name:t,color:e});return await fetch(`${this.GARAGE}`,{method:"POST",headers:{"Content-Type":"application/json"},body:n})}async deleteCar(t){return await fetch(`${this.GARAGE}/${t}`,{method:"DELETE"})}async updateCar(t,e,n){const r=JSON.stringify({name:t,color:e});return await fetch(`${this.GARAGE}/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:r})}},o=new class{constructor(){this.WINNERS="http://127.0.0.1:3000/winners"}async getWinners(t,e,n){const r=`${this.WINNERS}?_page=${t}&_limit=10&_sort=${e}&_order=${n}`,i=await fetch(r),s=await i.json();if(!function(t){return Array.isArray(t)&&t.every((t=>t&&"id"in t&&"wins"in t&&"time"in t))}(s))throw new TypeError("Invalid data");return s}async getWinner(t){return await fetch(`${this.WINNERS}/${t}`)}async getAllWinners(){return(await fetch(`${this.WINNERS}?_limit=10`)).headers.get("X-Total-Count")}async createWinner({id:t,time:e,wins:n=1}){const r=JSON.stringify({id:t,wins:n,time:e});await fetch(`${this.WINNERS}`,{method:"POST",headers:{"Content-Type":"application/json"},body:r})}async deleteWinner(t){await fetch(`${this.WINNERS}/${t}`,{method:"DELETE"})}async updateWinner({id:t,wins:e,time:n}){const r=JSON.stringify({wins:e,time:n});await fetch(`${this.WINNERS}/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:r})}},a=new class{constructor(){this.cars={curPage:1,allPages:1,allCars:"4",selectedId:0,selectedName:"",selectedColor:""},this.winners={curPage:1,allPages:1,allWinners:"1"},this.updateCarsState=async()=>{this.carsArr=await s.getCars(this.cars.curPage);const t=await s.getAllCars();t&&(this.cars.allCars=t),this.cars.allPages=Math.ceil(+this.cars.allCars/7)},this.updateWinnersState=async()=>{const t=await o.getWinners(this.winners.curPage,this.winnersSort,this.winnersOrder),e=[];t.forEach((t=>{e.push(s.getCar(t.id))}));const n=await Promise.all(e),r=t.reduce(((t,e)=>{const r=e.wins,i=e.time,s=n.find((t=>t.id===e.id));if(!s)return t;const o=s.color,a=s.name;return t.push({color:o,name:a,wins:r,time:i}),t}),[]);this.winnersArr=r;const i=await o.getAllWinners();i&&(this.winners.allWinners=i),this.winners.allPages=Math.ceil(+this.winners.allWinners/10)},this.carsArr=[],this.winnersArr=[],this.garageItems=[],this.winnersSort="time",this.winnersOrder="DESC"}},c="button";class d extends t{constructor(t){super({className:["pagination"]}),this.prevButton=new e([c,"pagination-prev"],"",{type:"button"}),this.nextButton=new e([c,"pagination-next"],"",{type:"button"}),this.config=t,this.appendChildren([this.prevButton.getNode(),this.nextButton.getNode()]),this.initNextButton(),this.initPrevButton()}buttonsHandler(){const{curPage:t,allPages:e}=this.config.getState();t<e&&e>1?this.nextButton.removeAttribute("disabled"):this.nextButton.setAttribute({disabled:"true"}),t>1&&e>1?this.prevButton.removeAttribute("disabled"):this.prevButton.setAttribute({disabled:"true"})}nextPage(){const{curPage:t}=this.config.getState();this.config.setPage(t+1),this.config.renderView().catch(console.error)}prevPage(){const{curPage:t}=this.config.getState();this.config.setPage(t-1),this.config.renderView().catch(console.error)}initNextButton(){this.nextButton.addOnClick((()=>this.nextPage()))}initPrevButton(){this.prevButton.addOnClick((()=>this.prevPage()))}}const u=new d({getState:()=>a.cars,setPage:t=>{a.cars.curPage=t},renderView:()=>b.render()}),l=new d({getState:()=>a.winners,setPage:t=>{a.winners.curPage=t},renderView:()=>f.render()}),h="button";class m{constructor(t,n,r){this.controller=new AbortController,this.startButton=new e([h,"cars-start"],"",{type:"button",title:"start"}),this.resetButton=new e([h,"cars-reset"],"",{type:"button",title:"reset",disabled:"true"}),this.selectButton=new e([h,"cars-select"],"",{type:"button",title:"select"}),this.removeButton=new e([h,"cars-remove"],"",{type:"button",title:"remove"}),this.name=t,this.color=n,this.id=r,this.car=this.createItem(),this.flag=this.createFinishFlag(),this.initStartButton(),this.initResetButton(),this.initSelectButton(),this.initRemoveButton()}selectCar(){C.textInputUpdate.removeAttribute("disabled"),C.colorInputUpdate.removeAttribute("disabled"),C.updateButton.removeAttribute("disabled"),this.id&&(a.cars.selectedId=this.id),this.name&&(a.cars.selectedName=this.name,C.textInputUpdate.getNode().value=this.name),this.color&&(a.cars.selectedColor=this.color,C.colorInputUpdate.getNode().value=this.color)}initSelectButton(){this.selectButton.addOnClick((()=>{this.selectCar()}))}async deleteCar(){this.id&&(await o.deleteWinner(this.id),await s.deleteCar(this.id),b.render().catch(console.error),f.render().catch(console.error))}initRemoveButton(){this.removeButton.addOnClick((()=>{this.deleteCar().catch(console.error)}))}async start(){if(this.controller=new AbortController,this.startButton.setAttribute({disabled:"true"}),this.selectButton.setAttribute({disabled:"true"}),this.removeButton.setAttribute({disabled:"true"}),this.resetButton.removeAttribute("disabled"),!this.id)throw new Error("ID does not exist");const{distance:t,velocity:e}=await s.startCar(this.id),n=t/e;return this.car.classList.add("start"),this.car.style.animationPlayState="",this.car.style.animationDuration=`${n}ms`,new Promise(((t,e)=>{this.id&&s.driveCar(this.id,this.controller).then((r=>{const i=this.id,s=this.name;if(!r.ok)throw this.stopCar(),new Error(`Car is brocken>> ${i}`);i&&s?t({id:i,name:s,time:n}):e(new Error("Error"))})).catch((()=>{}))}))}async reset(){this.controller.abort(),this.id&&(await s.stopCar(this.id),this.controller=new AbortController,this.car.classList.remove("start"),this.car.style.transform="translateX(0)",this.resetButton.setAttribute({disabled:"true"}),this.startButton.removeAttribute("disabled"),this.selectButton.removeAttribute("disabled"),this.removeButton.removeAttribute("disabled"))}renderGarageItem(){const e=new t({tag:"h5",text:this.name,className:["cars-title"]}),n=new t({className:["cars-buttons"]});return n.appendChildren([this.startButton.getNode(),this.resetButton.getNode(),this.selectButton.getNode(),this.removeButton.getNode(),e.getNode()]),new t({className:["cars-container"],children:[n.getNode(),this.car,this.flag]}).getNode()}createItem(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.style.width="4.2rem",t.style.height="4.2rem",this.color&&(t.style.fill=this.color);const e=document.createElementNS("http://www.w3.org/2000/svg","use");return e.setAttribute("href","#car"),t.append(e),t}createFinishFlag(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.style.width="4rem",t.style.height="4rem",t.classList.add("cars-finish");const e=document.createElementNS("http://www.w3.org/2000/svg","use");return e.setAttribute("href","#finish"),t.append(e),t}initStartButton(){this.startButton.addOnClick((()=>{this.start().catch(console.error)}))}initResetButton(){this.resetButton.addOnClick((()=>{this.reset().catch(console.error)}))}stopCar(){this.car.style.animationPlayState="paused"}}class p{constructor({number:e,color:n,name:r,wins:i,time:s}){this.carNumber=new t({tag:"li",className:[w.WINNERS_ITEM,w.WINNER]}),this.carModel=new t({tag:"li",className:[w.WINNERS_ITEM,w.WINNER]}),this.carName=new t({tag:"li",className:[w.WINNERS_ITEM,w.WINNER]}),this.winsAmount=new t({tag:"li",className:[w.WINNERS_ITEM,w.WINNER]}),this.timeResult=new t({tag:"li",className:[w.WINNERS_ITEM,w.WINNER]}),this.number=e,this.wins=i,this.time=s,this.name=r,this.color=n,this.car=(new m).car}renderWinnerItem(){return this.car.style.fill=this.color,this.car.style.width="9rem",this.car.style.height="3rem",this.car.classList.add(w.WINNER),this.carNumber.setTextContent(`${this.number}`),this.carName.setTextContent(this.name),this.winsAmount.setTextContent(`${this.wins}`),this.timeResult.setTextContent(`${this.time}`),new t({tag:"ul",className:[w.WINNERS_TABLE],children:[this.carNumber.getNode(),this.car,this.carName.getNode(),this.winsAmount.getNode(),this.timeResult.getNode()]}).getNode()}}const g=n.p+"ca93ab1a5f3f0914772f.png",w={WINNERS:"winners",CARS_COUNTER:"cars-counter",PAGE_COUNTER:"page-counter",WINNERS_TABLE:"winners-table",WINNERS_ITEM:"winners-item",WINNERS_BUTTON:"winners-button",WINNERS_SORT:"winners-sort",SORTED:"sorted",WINNER:"winner"},f=new class extends t{constructor(){super({className:[w.WINNERS]}),this.winnersCounter=new t({tag:"h2",className:[w.CARS_COUNTER]}),this.pageCounter=new t({tag:"h3",className:[w.PAGE_COUNTER]}),this.number=new t({className:[w.WINNERS_ITEM],text:"number"}),this.car=new t({className:[w.WINNERS_ITEM],text:"car"}),this.name=new e([w.WINNERS_ITEM,w.WINNERS_BUTTON],"name",{type:"button"}),this.nameArrow=new t({tag:"img",className:[w.WINNERS_SORT],attributes:{src:g}}),this.wins=new e([w.WINNERS_ITEM,w.WINNERS_BUTTON],"wins",{type:"button"}),this.winsArrow=new t({tag:"img",className:[w.WINNERS_SORT],attributes:{src:g}}),this.time=new e([w.WINNERS_ITEM,w.WINNERS_BUTTON],"time",{type:"button"}),this.timeArrow=new t({tag:"img",className:[w.WINNERS_SORT],attributes:{src:g}}),this.winnersTable=new t({className:[w.WINNERS_TABLE],children:[this.number.getNode(),this.car.getNode(),this.name.getNode(),this.wins.getNode(),this.time.getNode()]}),this.winnersContainer=new t({}),this.pagination=l,this.name.appendChildren([this.nameArrow.getNode()]),this.wins.appendChildren([this.winsArrow.getNode()]),this.time.appendChildren([this.timeArrow.getNode()]),this.appendChildren([this.winnersCounter.getNode(),this.pageCounter.getNode(),this.winnersTable.getNode(),this.winnersContainer.getNode(),this.pagination.getNode()]),this.initNameButton(),this.initWinsButton(),this.initTimeButton(),this.render().catch(console.error)}async render(){await a.updateWinnersState(),this.renderCounters(),this.renderWinners(),this.checkWinnersSort(),this.pagination.buttonsHandler()}sortById(){this.winsArrow.setClassName(["hidden"]),this.timeArrow.setClassName(["hidden"]),this.nameArrow.removeClassName(["hidden"]),this.nameArrow.toggleClass(w.SORTED),a.winnersSort="id",this.toggleOrder(),this.render().catch(console.error)}initNameButton(){this.name.addOnClick((()=>{this.sortById()}))}sortByWins(){this.winsArrow.removeClassName(["hidden"]),this.timeArrow.setClassName(["hidden"]),this.nameArrow.setClassName(["hidden"]),a.winnersSort="wins",this.toggleOrder(),this.render().catch(console.error)}initWinsButton(){this.wins.addOnClick((()=>{this.sortByWins()}))}sortByTime(){this.timeArrow.removeClassName(["hidden"]),this.winsArrow.setClassName(["hidden"]),this.nameArrow.setClassName(["hidden"]),a.winnersSort="time",this.toggleOrder(),this.render().catch(console.error)}checkWinnersSort(){"wins"===a.winnersSort&&(this.winsArrow.removeClassName(["hidden"]),this.timeArrow.setClassName(["hidden"]),this.nameArrow.setClassName(["hidden"])),"time"===a.winnersSort&&(this.timeArrow.removeClassName(["hidden"]),this.winsArrow.setClassName(["hidden"]),this.nameArrow.setClassName(["hidden"])),"id"===a.winnersSort&&(this.nameArrow.removeClassName(["hidden"]),this.timeArrow.setClassName(["hidden"]),this.winsArrow.setClassName(["hidden"]))}toggleOrder(){a.winnersOrder="ASC"===a.winnersOrder?"DESC":"ASC",this.timeArrow.toggleClass(w.SORTED),this.winsArrow.toggleClass(w.SORTED)}initTimeButton(){this.time.addOnClick((()=>{this.sortByTime()}))}renderCounters(){this.winnersCounter.setTextContent(`Winners ( ${a.winners.allWinners} )`),this.pageCounter.setTextContent(`Page #${a.winners.curPage} / ${a.winners.allPages}`)}renderWinners(){this.winnersContainer.destroyChildren();const t=a.winnersArr.map(((t,e)=>new p({number:e+1+10*(a.winners.curPage-1),color:t.color,name:t.name,wins:t.wins,time:t.time})));this.winnersContainer.appendChildren(t.map((t=>t.renderWinnerItem())))}},y="settings-text",N="settings-color",v="button",C=new class extends t{constructor(){super({className:["settings"]}),this.INIT_COLOR="#DCEAE6",this.textInputCreation=new t({tag:"input",className:[y,"settings-text_create"],attributes:{type:"text"}}),this.colorInputCreation=new t({tag:"input",className:[N,"settings-color_create"],attributes:{type:"color",value:this.INIT_COLOR}}),this.createButton=new e([v,"car-create"],"create",{type:"button"}),this.raceButton=new e([v,"car-race"],"race",{type:"button"}),this.resetButton=new e([v,"car-reset"],"reset",{type:"button"}),this.generateButton=new e([v,"car-generate"],"generate cars",{type:"button"}),this.message=new t({className:["race-winner"]}),this.updateButton=new e([v,"car-update"],"update",{type:"button",disabled:"true"}),this.textInputUpdate=new t({tag:"input",className:[y,"settings-text_update"],attributes:{type:"text",disabled:"true"}}),this.colorInputUpdate=new t({tag:"input",className:[N,"settings-color_update"],attributes:{type:"color",value:this.INIT_COLOR,disabled:"true"}}),this.appendChildren([this.textInputCreation.getNode(),this.colorInputCreation.getNode(),this.createButton.getNode(),this.textInputUpdate.getNode(),this.colorInputUpdate.getNode(),this.updateButton.getNode(),this.raceButton.getNode(),this.resetButton.getNode(),this.generateButton.getNode()]),this.inputsCreationHandler(),this.initUpdateButton(),this.initRaceButton(),this.initResetButton(),this.initGenerateButton()}async createCar(){const t=this.textInputCreation.getNode().value,e=this.colorInputCreation.getNode().value;this.textInputCreation.getNode().value="",this.colorInputCreation.getNode().value=this.INIT_COLOR,await s.createCar(t,e),b.render().catch(console.error)}inputsCreationHandler(){this.createButton.addOnClick((()=>{this.createCar().catch(console.error)}))}async updateGarageItem(){const t=this.textInputUpdate.getNode().value,e=this.colorInputUpdate.getNode().value;await s.updateCar(t,e,a.cars.selectedId),await b.render().catch(console.error),this.textInputUpdate.getNode().value="",this.colorInputUpdate.getNode().value=this.INIT_COLOR,this.updateButton.setAttribute({disabled:"true"}),this.textInputUpdate.setAttribute({disabled:"true"}),this.colorInputUpdate.setAttribute({disabled:"true"})}initUpdateButton(){this.updateButton.addOnClick((()=>{this.updateGarageItem().catch(console.error)}))}async race(){const t=a.garageItems.map((t=>t.start())),e=await Promise.any(t),{name:n,id:r,time:i}=e,s=+(i/1e3).toFixed(2);this.messageResult(n,s),setTimeout((()=>this.message.getNode().remove()),7e3);const c=await o.getWinner(r);c.ok||await o.createWinner({id:r,time:s}),c.ok&&await this.updateWinnerData(r,s,c),await f.render().catch(console.error)}messageResult(t,e){this.message.setTextContent(""),this.message.setTextContent(`${t.toUpperCase()} won with time ${e} sec`),b.appendChildren([this.message.getNode()])}async updateWinnerData(t,e,n){const r=await n.json();if("object"!=typeof r||null===r)return;let i=null,s=null,a=null;"id"in r&&"number"==typeof r.id&&(i=r.id),"time"in r&&"number"==typeof r.time&&(s=r.time),"wins"in r&&"number"==typeof r.wins&&(a=r.wins),null!==i&&null!==s&&null!==a&&(a+=1,s=Math.min(s,e),await o.updateWinner({id:i,wins:a,time:s}))}initRaceButton(){this.raceButton.addOnClick((()=>{this.race().catch(console.error),this.disableButtons()}))}raceReset(){a.garageItems.map((t=>{t.reset()})),setTimeout((()=>this.turnOnButtons()),2e3)}initResetButton(){this.resetButton.addOnClick((()=>{this.raceReset()}))}async generateAHundretCars(){let t=100;for(;t>0;)await s.createCar(i(),`rgb(${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())}, ${Math.floor(256*Math.random())})`).then((()=>{t-=1})).catch(console.error);b.render().catch(console.error)}initGenerateButton(){this.generateButton.addOnClick((()=>{this.generateAHundretCars().catch(console.error)}))}disableButtons(){S.ButtonGarage.setAttribute({disabled:"true"}),S.ButtonWinners.setAttribute({disabled:"true"}),this.raceButton.setAttribute({disabled:"true"}),this.generateButton.setAttribute({disabled:"true"}),this.createButton.setAttribute({disabled:"true"}),this.textInputCreation.setAttribute({disabled:"true"}),this.colorInputCreation.setAttribute({disabled:"true"}),u.prevButton.setAttribute({disabled:"true"}),u.nextButton.setAttribute({disabled:"true"})}turnOnButtons(){S.ButtonGarage.removeAttribute("disabled"),S.ButtonWinners.removeAttribute("disabled"),this.raceButton.removeAttribute("disabled"),this.generateButton.removeAttribute("disabled"),this.createButton.removeAttribute("disabled"),this.textInputCreation.removeAttribute("disabled"),this.colorInputCreation.removeAttribute("disabled"),u.prevButton.removeAttribute("disabled"),u.nextButton.removeAttribute("disabled"),u.buttonsHandler()}},b=new class extends t{constructor(){super({tag:"div",className:["garage"]}),this.carsCounter=new t({tag:"h2",className:["cars-counter"]}),this.pageCounter=new t({tag:"h3",className:["page-counter"]}),this.carsContainer=new t({className:["cars"]}),this.pagination=u,this.appendChildren([C.getNode(),this.carsCounter.getNode(),this.pageCounter.getNode(),this.carsContainer.getNode(),this.pagination.getNode()]),this.render().catch(console.error)}async render(){await a.updateCarsState(),this.renderCounters(),this.renderCars(),this.pagination.buttonsHandler()}renderCounters(){this.carsCounter.setTextContent(`garage ( ${a.cars.allCars} )`),this.pageCounter.setTextContent(`page #${a.cars.curPage}  /  ${a.cars.allPages}`)}renderCars(){this.carsContainer.destroyChildren();const t=a.carsArr.map((t=>new m(t.name,t.color,t.id)));a.garageItems=t,this.carsContainer.appendChildren(t.map((t=>t.renderGarageItem())))}},E=new class extends t{constructor(){super({tag:"main",className:["container","main"]}),this.appendChildren([b.getNode()])}},A="container",B="button",S=new class extends t{constructor(){super({tag:"header",className:[A,"header"]}),this.nav=new t({tag:"nav",className:[A,"nav"]}),this.ButtonGarage=new e([B],"garage",{type:"button"}),this.ButtonWinners=new e([B],"winners",{type:"button"}),this.nav.appendChildren([this.ButtonGarage.getNode(),this.ButtonWinners.getNode()]),this.append(this.nav),this.initWinnersButton(),this.initGarageButton()}goToWinners(){E.destroyChildren(),E.append(f)}goToGarage(){E.destroyChildren(),E.append(b)}initWinnersButton(){this.ButtonWinners.addOnClick((()=>{this.goToWinners()}))}initGarageButton(){this.ButtonGarage.addOnClick((()=>{this.goToGarage()}))}},x=new class extends t{constructor(){super({tag:"footer",className:["container","footer"]}),this.copyrightLink=new t({tag:"a",className:["footer-copyright-link"],attributes:{href:"https://github.com/rolling-scopes-school/tasks/tree/master/stage2/tasks/async-race",target:"blank"},text:"async race"}),this.copyrightText=new t({tag:"p",className:["footer-copyright"],text:"2025"}),this.copyrightContainer=new t({className:["footer-container"],children:[this.copyrightLink.getNode(),this.copyrightText.getNode()]}),this.appendChildren([this.copyrightContainer.getNode()])}},I=new class{start(){document.body.append(S.getNode(),E.getNode(),x.getNode())}};var T=n(897),O=n.n(T),R=n(42),W=n.n(R),_=new(O())({id:"car",use:"car-usage",viewBox:"0 0 17.485 17.485",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 17.485 17.485" id="car">\r\n<g>\r\n\t<g>\r\n\t\t<path style="" d="M17.477,8.149c-0.079-0.739-3.976-0.581-3.976-0.581L11.853,5.23H4.275L3.168,7.567H0v2.404\r\n\t\t\tl2.029,0.682c0.123-0.836,0.843-1.48,1.711-1.48c0.939,0,1.704,0.751,1.73,1.685l6.62,0.041c0.004-0.951,0.779-1.726,1.733-1.726\r\n\t\t\tc0.854,0,1.563,0.623,1.704,1.439l1.479-0.17C17.006,10.442,17.556,8.887,17.477,8.149z M4.007,7.568l0.746-1.771h2.864\r\n\t\t\tl0.471,1.771H4.007z M8.484,7.568L8.01,5.797h3.67l1.137,1.771H8.484z" />\r\n\t\t<circle style="fill:#dae6e2;" cx="3.759" cy="10.966" r="1.289" />\r\n\t\t<circle style="fill:#dae6e2;" cx="13.827" cy="10.9" r="1.29" />\r\n\t</g>\r\n</g>\r\n</symbol>'});W().add(_);var M=new(O())({id:"finish",use:"finish-usage",viewBox:"0 0 511.988 511.988",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 511.988 511.988" id="finish">\r\n<path style="fill:#E6E9ED;" d="M441.833,66.06c-3.75-1.75-8.172-1.172-11.359,1.484c-24.045,20.11-53.045,30.75-83.827,30.75\r\n\tc-30.482,0-60.311-10.921-83.998-30.75c-27.889-23.249-61.529-35.546-97.31-35.546c-34.78,0-68.857,12.266-96.139,34.562\r\n\tc-3.125,1.875-5.202,5.281-5.202,9.172v232.525c0,4.141,2.39,7.906,6.14,9.656c3.766,1.75,8.188,1.172,11.359-1.484\r\n\tc24.031-20.093,53.03-30.702,83.842-30.702s59.796,10.609,83.826,30.718c27.468,22.922,62.093,35.547,97.481,35.547\r\n\tc34.781,0,68.858-12.266,96.139-34.578c3.109-1.859,5.203-5.266,5.203-9.156V75.732C447.989,71.592,445.583,67.826,441.833,66.06z" />\r\n<g>\r\n\t<path style="fill:#434A54;" d="M351.991,351.898c32.906-1.188,64.921-13.312,90.795-34.484c3.109-1.859,5.203-5.266,5.203-9.156\r\n\t\tV75.732c0-4.141-2.406-7.906-6.156-9.672c-3.75-1.75-8.172-1.172-11.359,1.484c-22.655,18.953-49.686,29.468-78.482,30.64\r\n\t\tL351.991,351.898L351.991,351.898z" />\r\n\t<path style="fill:#434A54;" d="M255.806,62.154c-26.468-19.749-57.562-30.155-90.467-30.155c-1.781,0-3.562,0.047-5.344,0.109\r\n\t\tv253.729c1.766-0.078,3.547-0.109,5.344-0.109c30.812,0,59.796,10.609,83.826,30.718c2.172,1.812,4.391,3.547,6.641,5.219V62.154z" />\r\n</g>\r\n<path style="fill:#E6E9ED;" d="M69.201,66.56c-3.125,1.875-5.202,5.281-5.202,9.172v232.525c0,4.141,2.39,7.906,6.14,9.656\r\n\tc3.766,1.75,8.188,1.172,11.359-1.484c22.641-18.921,49.687-29.437,78.498-30.593l0,0V32.108\r\n\tC127.091,33.296,95.092,45.405,69.201,66.56z" />\r\n<path style="fill:#434A54;" d="M156.152,161.668c-32.671,0-64.779,8.938-92.153,25.405v121.185c0,4.141,2.39,7.906,6.14,9.656\r\n\tc3.766,1.75,8.188,1.172,11.359-1.484c22.641-18.921,49.687-29.437,78.498-30.593l0,0V161.715\r\n\tC158.715,161.683,157.433,161.668,156.152,161.668z" />\r\n<g>\r\n\t<path style="fill:#E6E9ED;" d="M255.806,321.664V191.839c-28.124-19.062-60.983-29.421-95.811-30.124v124.122\r\n\t\tc1.766-0.078,3.547-0.109,5.344-0.109c30.812,0,59.796,10.609,83.826,30.718C251.338,318.258,253.556,319.992,255.806,321.664z" />\r\n\t<path style="fill:#E6E9ED;" d="M447.989,308.258V197.354c-26.452,20.016-58.311,30.609-92.154,30.609\r\n\t\tc-1.281,0-2.562-0.031-3.844-0.062v123.998c32.906-1.188,64.921-13.312,90.795-34.484\r\n\t\tC445.895,315.555,447.989,312.148,447.989,308.258z" />\r\n</g>\r\n<path style="fill:#ED5564;" d="M74.654,511.988c-5.891,0-10.655-4.766-10.655-10.656V10.671C63.999,4.78,68.764,0,74.654,0\r\n\ts10.672,4.781,10.672,10.671v490.661C85.326,507.223,80.545,511.988,74.654,511.988z" />\r\n<path style="fill:#434A54;" d="M351.991,227.901c-32.232-0.797-63.576-11.609-88.67-30.687c-2.469-1.859-4.969-3.656-7.515-5.375\r\n\tv129.825c26.312,19.609,58.249,30.328,90.841,30.328c1.781,0,3.562-0.031,5.344-0.094V227.901z" />\r\n</symbol>'});W().add(M),document.addEventListener("DOMContentLoaded",(()=>{I.start()}))})()})();